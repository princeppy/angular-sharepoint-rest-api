!function(){"use strict";angular.module("spNgModule",["ng"]).value("$spNgModuleConfig",{isAppWeb:!1})}(),function(){"use strict";angular.module("spNgModule").directive("customFileChange",function(e){return{restrict:"A",link:function(t,a,r){var s=e(r.customFileChange).assign;a.bind("change",function(){t.$apply(function(){var e=new FileReader;e.onload=function(e){var r={fileName:a[0].files[0].name,fileAsBuffer:e.target.result};s(t,r)},e.onerror=function(e){alert(e.target.error)},e.readAsArrayBuffer(a[0].files[0])})})}}})}(),function(){"use strict";function e(e,t,a,r){var s=a.isAppWeb?_spPageContextInfo.webAbsoluteUrl:_spPageContextInfo.siteAbsoluteUrl;return{getRequest:function(a,r){var n=e.defer();return t({url:r||s+a,method:"GET",headers:{accept:"application/json;odata=verbose","content-Type":"application/json;odata=verbose"}}).then(function(e){n.resolve(e.data.d.results)},function(e){n.reject({error:e.statusText,status:e.status})}),n.promise},postRequest:function(a,n,i){var l=e.defer();return t({url:i||s+n,method:"POST",headers:{accept:"application/json;odata=verbose","X-RequestDigest":r[0].getElementById("__REQUESTDIGEST").value,"content-Type":"application/json;odata=verbose"},data:JSON.stringify(a)}).then(function(e){l.resolve(e.data.d.results)},function(e){l.reject({error:e.statusText,status:e.status})}),l.promise},updateRequest:function(a,n,i){var l=e.defer();return t({url:i||s+n,method:"PATCH",headers:{accept:"application/json;odata=verbose","X-RequestDigest":r[0].getElementById("__REQUESTDIGEST").value,"content-Type":"application/json;odata=verbose","X-Http-Method":"PATCH","If-Match":"*"},data:JSON.stringify(a)}).then(function(e){l.resolve(e.data.d.results)},function(e){l.reject({error:e.statusText,status:e.status})}),l.promise},deleteRequest:function(a,n){var i=e.defer();return t({url:n||s+a,method:"DELETE",headers:{accept:"application/json;odata=verbose","X-RequestDigest":r[0].getElementById("__REQUESTDIGEST").value,"IF-MATCH":"*"}}).then(function(e){i.resolve(e.data.d.results)},function(e){i.reject({error:e.statusText,status:e.status})}),i.promise},fileUploadRequest:function(a,n,i){var l=e.defer();return t({url:i||s+n,method:"POST",processData:!1,data:a,transformRequest:angular.identity,headers:{accept:"application/json;odata=verbose","X-RequestDigest":r[0].getElementById("__REQUESTDIGEST").value,"Content-Type":void 0}}).then(function(e){l.resolve(e.data.d.results)},function(e){l.reject({error:e.statusText,status:e.status})}),l.promise},baseUrl:s}}angular.module("spNgModule").factory("$spBaseService",e),e.$inject=["$q","$http","$spNgModuleConfig","$document"]}(),function(){"use strict";angular.module("spNgModule").factory("$spConvertService",function(){var e=function(e,a){if(!angular.isObject(a.__metadata)||a.__metadata.type!==e)throw t("badargs","expected argument to be of type {0}.",e)},t=angular.$$minErr("$spConvert"),a={spKeyValue:function(t){e("SP.KeyValue",t);var a=t.Value;switch(t.ValueType){case"Edm.Double":case"Edm.Float":return parseFloat(a);case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":case"Edm.Byte":return parseInt(a,10);case"Edm.Boolean":return"true"===a;default:return a}},spKeyValueArray:function(e){for(var t={},r=0,s=e.length;r<s;r+=1){var n=e[r];t[n.Key]=a.spKeyValue(n)}return t},spSimpleDataRow:function(t){e("SP.SimpleDataRow",t);var r=t.Cells.results||[];return a.spKeyValueArray(r)},spSimpleDataTable:function(t){e("SP.SimpleDataTable",t);for(var r=[],s=t.Rows.results||[],n=0,i=s.length;n<i;n+=1){var l=s[n];r.push(a.spSimpleDataRow(l))}return r},searchResult:function(t){e("Microsoft.Office.Server.Search.REST.SearchResult",t);var r=t.PrimaryQueryResult;return{elapsedTime:t.ElapsedTime,spellingSuggestion:t.SpellingSuggestion,properties:a.spKeyValueArray(t.Properties.results),primaryQueryResult:{queryId:r.QueryId,queryRuleId:r.QueryRuleId,relevantResults:a.spSimpleDataTable(r.RelevantResults.Table),customResults:r.CustomResults,refinementResults:r.RefinementResults,specialTermResults:r.SpecialTermResults}}},suggestResult:function(e){return e},userResult:function(t){return e("SP.UserProfiles.PersonProperties",t),{accountName:t.AccountName,displayName:t.DisplayName,email:t.Email,isFollowed:t.IsFollowed,personalUrl:t.PersonalUrl,pictureUrl:t.PictureUrl,profileProperties:a.spKeyValueArray(t.UserProfileProperties.results),title:t.Title,userUrl:t.UserUrl}},capitalize:function(e){return angular.isUndefined(e)||null===e?null:e.charAt(0).toUpperCase()+e.slice(1)}};return a})}(),function(){"use strict";function e(e,t,a,r,s){var n=angular.$$minErr("$spList"),i=_spPageContextInfo.webAbsoluteUrl,l=i.trimEnd("/")+"/_api/web/lists/";String.prototype.trimStart=function(e){return void 0===e&&(e="s"),this.replace(new RegExp("^["+e+"]+"),"")},String.prototype.trimEnd=function(e){return void 0===e&&(e="s"),this.replace(new RegExp("["+e+"]+$"),"")},String.prototype.trim=function(e){return this.trimStart(e).trimEnd(e)};var o=function(e,t){if(!angular.isString(e)||""===e)throw n("badargs","title must be a nen-empty string.");this.title=e,this.listOptions=angular.extend({},t||{}),this.baseUrl=i,this.baseAPIUrl=l,this.normalizedTitle=s.capitalize(this.title.replace(/[^A-Za-z0-9 ]/g,"").replace(/\s/g,"_x0020_")),this.className=s.capitalize(this.normalizedTitle.replace(/_x0020/g,"").replace(/^\d+/,"")),this.listItemType="SP.Data."+this.normalizedTitle+"ListItem",this.__metadata={type:this.listItemType},this.Url=l+"GetByTitle('"+this.title+"')"};return o.prototype={init:function(){var e=this.Url+"?$expand=ContentTypes";e+=",Fields",e+=",Items,Items/AttachmentFiles",this.listUrl=e;var a={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"GET"};return t({url:e,method:"GET",headers:a}).then(function(t){console.log("results from => ",e),this.Url=t.data.d.__metadata.uri,this.etag=t.data.d.__metadata.etag.toString(),this.AllowContentTypes=t.data.d.AllowContentTypes,this.BaseTemplate=t.data.d.BaseTemplate,this.ContentTypesEnabled=t.data.d.ContentTypesEnabled,this.EnableAttachments=t.data.d.EnableAttachments,this.EnableFolderCreation=t.data.d.EnableFolderCreation,this.EnableMinorVersions=t.data.d.EnableMinorVersions,this.EnableModeration=t.data.d.EnableModeration,this.EnableVersioning=t.data.d.EnableVersioning,this.EntityTypeName=t.data.d.EntityTypeName,this.Hidden=t.data.d.Hidden,this.Id=t.data.d.Id,this.ItemCount=t.data.d.ItemCount,this.ParentWebUrl=t.data.d.ParentWebUrl,this.Title=t.data.d.Title,this.ListItemEntityTypeFullName=t.data.d.ListItemEntityTypeFullName,this.ContentTypes=t.data.d.ContentTypes.results.map(function(e){return{Id:e.Id.StringValue,Name:e.Name}}),this.Fields=t.data.d.Fields.results.filter(function(e){return!1===e.ReadOnlyField}).map(function(e){return{Title:e.Title,StaticName:e.StaticName,InternalName:e.InternalName,Type:e.__metadata.type}}),this.Items=[],angular.forEach(t.data.d.Items.results,function(e,t){if(e.metadatatype=e.__metadata.type,e.uri=e.__metadata.uri,e.etag=e.__metadata.etag.toString(),e.Attachments){var a=[];a=e.AttachmentFiles.results.map(function(e){return{FileName:e.FileName,FileUrl:_spPageContextInfo.webAbsoluteUrl+"/"+e.ServerRelativeUrl}}),e.Attachments=a}this.push(_.omit(e,["__metadata","ID","FirstUniqueAncestorSecurableObject","RoleAssignments","AttachmentFiles","ContentType","GetDlpPolicyTip","FieldValuesAsHtml","FieldValuesAsText","FieldValuesForEdit","File","Folder","ParentList","FileSystemObjectType","OData__UIVersionString","AuthorId","EditorId"]))},this.Items)})},createItem:function(e){},editItem:function(e){},deleteItem:function(e){}},o}angular.module("spNgModule").factory("$spListService",e),e.$inject=["$q","$http","$spNgModuleConfig","$document","$spConvertService"]}();