!function(){"use strict";angular.module("spNgModule",["ng"]).value("$spNgModuleConfig",{isAppWeb:!1})}(),function(){"use strict";angular.module("spNgModule").directive("customFileChange",function(e){return{restrict:"A",link:function(t,a,r){var n=e(r.customFileChange).assign;a.bind("change",function(){t.$apply(function(){var e=new FileReader;e.onload=function(e){var r={fileName:a[0].files[0].name,fileAsBuffer:e.target.result};n(t,r)},e.onerror=function(e){alert(e.target.error)},e.readAsArrayBuffer(a[0].files[0])})})}}})}(),function(){"use strict";function e(e,t,a,r){var n=a.isAppWeb?_spPageContextInfo.webAbsoluteUrl:_spPageContextInfo.siteAbsoluteUrl;return{getRequest:function(a,r){var s=e.defer();return t({url:r||n+a,method:"GET",headers:{accept:"application/json;odata=verbose","content-Type":"application/json;odata=verbose"}}).then(function(e){s.resolve(e.data.d.results)},function(e){s.reject({error:e.statusText,status:e.status})}),s.promise},postRequest:function(a,s,i){var l=e.defer();return t({url:i||n+s,method:"POST",headers:{accept:"application/json;odata=verbose","X-RequestDigest":r[0].getElementById("__REQUESTDIGEST").value,"content-Type":"application/json;odata=verbose"},data:JSON.stringify(a)}).then(function(e){l.resolve(e.data.d.results)},function(e){l.reject({error:e.statusText,status:e.status})}),l.promise},updateRequest:function(a,s,i){var l=e.defer();return t({url:i||n+s,method:"PATCH",headers:{accept:"application/json;odata=verbose","X-RequestDigest":r[0].getElementById("__REQUESTDIGEST").value,"content-Type":"application/json;odata=verbose","X-Http-Method":"PATCH","If-Match":"*"},data:JSON.stringify(a)}).then(function(e){l.resolve(e.data.d.results)},function(e){l.reject({error:e.statusText,status:e.status})}),l.promise},deleteRequest:function(a,s){var i=e.defer();return t({url:s||n+a,method:"DELETE",headers:{accept:"application/json;odata=verbose","X-RequestDigest":r[0].getElementById("__REQUESTDIGEST").value,"IF-MATCH":"*"}}).then(function(e){i.resolve(e.data.d.results)},function(e){i.reject({error:e.statusText,status:e.status})}),i.promise},fileUploadRequest:function(a,s,i){var l=e.defer();return t({url:i||n+s,method:"POST",processData:!1,data:a,transformRequest:angular.identity,headers:{accept:"application/json;odata=verbose","X-RequestDigest":r[0].getElementById("__REQUESTDIGEST").value,"Content-Type":void 0}}).then(function(e){l.resolve(e.data.d.results)},function(e){l.reject({error:e.statusText,status:e.status})}),l.promise},baseUrl:n}}angular.module("spNgModule").factory("$spBaseService",e),e.$inject=["$q","$http","$spNgModuleConfig","$document"]}(),function(){"use strict";angular.module("spNgModule").factory("$spConvertService",function(){var e=function(e,a){if(!angular.isObject(a.__metadata)||a.__metadata.type!==e)throw t("badargs","expected argument to be of type {0}.",e)},t=angular.$$minErr("$spConvert"),a={spKeyValue:function(t){e("SP.KeyValue",t);var a=t.Value;switch(t.ValueType){case"Edm.Double":case"Edm.Float":return parseFloat(a);case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":case"Edm.Byte":return parseInt(a,10);case"Edm.Boolean":return"true"===a;default:return a}},spKeyValueArray:function(e){for(var t={},r=0,n=e.length;r<n;r+=1){var s=e[r];t[s.Key]=a.spKeyValue(s)}return t},spSimpleDataRow:function(t){e("SP.SimpleDataRow",t);var r=t.Cells.results||[];return a.spKeyValueArray(r)},spSimpleDataTable:function(t){e("SP.SimpleDataTable",t);for(var r=[],n=t.Rows.results||[],s=0,i=n.length;s<i;s+=1){var l=n[s];r.push(a.spSimpleDataRow(l))}return r},searchResult:function(t){e("Microsoft.Office.Server.Search.REST.SearchResult",t);var r=t.PrimaryQueryResult;return{elapsedTime:t.ElapsedTime,spellingSuggestion:t.SpellingSuggestion,properties:a.spKeyValueArray(t.Properties.results),primaryQueryResult:{queryId:r.QueryId,queryRuleId:r.QueryRuleId,relevantResults:a.spSimpleDataTable(r.RelevantResults.Table),customResults:r.CustomResults,refinementResults:r.RefinementResults,specialTermResults:r.SpecialTermResults}}},suggestResult:function(e){return e},userResult:function(t){return e("SP.UserProfiles.PersonProperties",t),{accountName:t.AccountName,displayName:t.DisplayName,email:t.Email,isFollowed:t.IsFollowed,personalUrl:t.PersonalUrl,pictureUrl:t.PictureUrl,profileProperties:a.spKeyValueArray(t.UserProfileProperties.results),title:t.Title,userUrl:t.UserUrl}},capitalize:function(e){return angular.isUndefined(e)||null===e?null:e.charAt(0).toUpperCase()+e.slice(1)}};return a})}(),function(){"use strict";function e(e,t,a,r,n,s){String.prototype.trimStart=function(e){return void 0===e&&(e="s"),this.replace(new RegExp("^["+e+"]+"),"")},String.prototype.trimEnd=function(e){return void 0===e&&(e="s"),this.replace(new RegExp("["+e+"]+$"),"")},String.prototype.trim=function(e){return this.trimStart(e).trimEnd(e)};var i=angular.$$minErr("$spList"),l=_spPageContextInfo.webAbsoluteUrl,o=l.trimEnd("/")+"/_api/web/lists/",u={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"GET"},d=function(e,a){if(!angular.isString(e)||""===e)throw i("badargs","title must be a nen-empty string.");var r=Object.create(this);r.baseUrl=l,r.baseAPIUrl=o,r.title=e,r.listOptions=angular.extend({},a||{}),r.normalizedTitle=n.capitalize(r.title.replace(/[^A-Za-z0-9 ]/g,"").replace(/\s/g,"_x0020_")),r.className=n.capitalize(r.normalizedTitle.replace(/_x0020/g,"").replace(/^\d+/,"")),r.listItemType="SP.Data."+r.normalizedTitle+"ListItem",r.__metadata={type:r.listItemType},r.Url=o+"GetByTitle('"+r.title+"')",r.Exist=!1;t({url:r.Url,method:"GET",headers:angular.extend({},u,{"X-HTTP-Method":"GET"})}).then(function(e){return r.Exist=!0,r.init()},function(e){throw r.Exist=!1,i("badargs","List with title '"+r.title+"' dosent exit.!!!")});return r};return d.prototype.init=function(){var a=this,r=this.Url+"?$expand=ContentTypes";r+=",Fields",r+=",Items,Items/AttachmentFiles",this.listUrl=r;var n=t({url:r,method:"GET",headers:angular.extend({},u,{"X-HTTP-Method":"GET"})}),s=e.defer();return n.then(function(e){a.Url=e.data.d.__metadata.uri,a.etag=e.data.d.__metadata.etag.toString(),a.AllowContentTypes=e.data.d.AllowContentTypes,a.BaseTemplate=e.data.d.BaseTemplate,a.ContentTypesEnabled=e.data.d.ContentTypesEnabled,a.EnableAttachments=e.data.d.EnableAttachments,a.EnableFolderCreation=e.data.d.EnableFolderCreation,a.EnableMinorVersions=e.data.d.EnableMinorVersions,a.EnableModeration=e.data.d.EnableModeration,a.EnableVersioning=e.data.d.EnableVersioning,a.EntityTypeName=e.data.d.EntityTypeName,a.Hidden=e.data.d.Hidden,a.Id=e.data.d.Id,a.ItemCount=e.data.d.ItemCount,a.ParentWebUrl=e.data.d.ParentWebUrl,a.Title=e.data.d.Title,a.ListItemEntityTypeFullName=e.data.d.ListItemEntityTypeFullName,a.ContentTypes=e.data.d.ContentTypes.results.map(function(e){return{Id:e.Id.StringValue,Name:e.Name}}),a.Fields=e.data.d.Fields.results.filter(function(e){return!1===e.ReadOnlyField}).map(function(e){return{Title:e.Title,StaticName:e.StaticName,InternalName:e.InternalName,Type:e.__metadata.type}}),a.Items=[],angular.forEach(e.data.d.Items.results,function(e,t){if(e.metadatatype=e.__metadata.type,e.uri=e.__metadata.uri,e.etag=e.__metadata.etag.toString(),e.Attachments){var a=[];a=e.AttachmentFiles.results.map(function(e){return{FileName:e.FileName,FileUrl:_spPageContextInfo.webAbsoluteUrl+"/"+e.ServerRelativeUrl}}),e.Attachments=a}this.push(_.omit(e,["__metadata","ID","FirstUniqueAncestorSecurableObject","RoleAssignments","AttachmentFiles","ContentType","GetDlpPolicyTip","FieldValuesAsHtml","FieldValuesAsText","FieldValuesForEdit","File","Folder","ParentList","FileSystemObjectType","OData__UIVersionString","AuthorId","EditorId"]))},a.Items),s.resolve(a)}),s.promise},d.prototype.createItem=function(a){var r=this;if(!angular.isObject(a))throw i("badargs","item must be a List instance.");var n=r.Url+"/Items",s=angular.extend({},a);s.__metadata||(s.__metadata=r.__metadata),s.__metadata.type||(s.__metadata.type=r.__metadata.type);var l=e.defer();return t({url:n,data:JSON.stringify(s),method:"POST",headers:angular.extend({},u,{"X-HTTP-Method":"POST"})}).then(function(e){var a=e.data.d;a.metadatatype=a.__metadata.type,a.uri=a.__metadata.uri,a.etag=a.__metadata.etag.toString();var n=_.omit(a,["__metadata","ID","FirstUniqueAncestorSecurableObject","RoleAssignments","AttachmentFiles","ContentType","GetDlpPolicyTip","FieldValuesAsHtml","FieldValuesAsText","FieldValuesForEdit","File","Folder","ParentList","FileSystemObjectType","OData__UIVersionString","AuthorId","EditorId"]);if(n.Attachments=[],n.Attachments){var s=r.Url+"/Items("+n.Id+")/?$expand=AttachmentFiles",i=[];t({url:s,method:"GET",headers:angular.extend({},u,{"X-HTTP-Method":"GET"})}).then(function(e){i=e.data.d.AttachmentFiles.results.map(function(e){return{FileName:e.FileName,FileUrl:_spPageContextInfo.webAbsoluteUrl+"/"+e.ServerRelativeUrl}}),n.Attachments=i,l.resolve(n)},function(e){l.resolve(n)})}else l.resolve(n)},function(e){l.reject(e)}),l.promise},d.prototype.editItem=function(e){if(!angular.isObject(e))throw i("badargs","item must be a List instance.");var a=this.Url+"/Items",r=angular.extend({},e);return r.__metadata||(r.__metadata=this.__metadata),r.__metadata.type||(r.__metadata.type=this.__metadata.type),t({url:a,data:JSON.stringify(r),method:"POST",headers:angular.extend({},u,{"X-HTTP-Method":"MERGE"})})},d.prototype.deleteItem=function(e){if(!e)throw i("badargs","item id must be valid.");var a=this.Url+"/Items("+e+")";if(!_.contains(this.Items,{Id:e}))throw i("badargs","item dosen't exist in the list.");var r=angular.extend({},{Id:e});return r.__metadata||(r.__metadata=this.__metadata),r.__metadata.type||(r.__metadata.type=this.__metadata.type),t({url:a,data:JSON.stringify(r),method:"DELETE",headers:angular.extend({},u,{"X-HTTP-Method":"DELETE","IF-MATCH":"*"})})},d}angular.module("spNgModule").factory("$spListService",e),e.$inject=["$q","$http","$spNgModuleConfig","$document","$spConvertService","$timeout"]}();